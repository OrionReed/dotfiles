- defaults:
    link:
      relink: true
      create: true
    shell:
      stderr: true
      stdout: true

- clean: ["~"]

- link:
    ~/.zshrc: configs/zshrc
    ~/.aliases: configs/aliases
    ~/.functions: configs/functions
    ~/.gitconfig: configs/gitconfig
    ~/.config/starship.toml: configs/starship.toml

- create:
    - ~/.config
    - ~/.local/bin

- shell:
    - description: Install Homebrew if not present
      command: |
        if ! command -v brew >/dev/null 2>&1; then
          echo "Installing Homebrew..."
          /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
        fi
        eval "$(/opt/homebrew/bin/brew shellenv)"

    - description: Install packages from Brewfile
      command: |
        eval "$(/opt/homebrew/bin/brew shellenv)"
        brew bundle --file=Brewfile --no-lock

- shell:
    - description: Apply shell configuration
      command: |
        if [ -f "$HOME/.zshrc" ]; then
          echo "âœ… Dotfiles installed! Run 'source ~/.zshrc' or restart your terminal"
        fi
